
<div *ngIf = "!rcaLoading && !rcaDisplayed && !otherDisplayed &&!modifierDisplayed" class="rca-bot-container ">
    <div class="rca-box-row-container rca-header-container">
        <h1 class="rca-header-text">EasyRCA!</h1>
        <!-- <div class = "rca-subtitle-text">{{mainCategoryPageText}}</div> -->
    </div>
    
    <div *ngIf = "!subcategoriesDisplayed" class="rca-box-row-container rca-samples-container">
        
        <div class="rca-box-row">
            <ng-container *ngFor="let cat of [].constructor(6); let i = index">

            <div class="rca-box2 rca-title-text" *ngIf = "i<=2 && ( i < categoryMapping.size) "  
              (click) = "mainCategoryClicked(categoryMappingKeys[i])">{{categoryMappingKeys[i]}}</div>
              <div class="empty-box" *ngIf = "i<=2 && ( i >= categoryMapping.size) "  
                [innerHTML] = ""></div>
            </ng-container>
        </div>
        <div class="rca-box-row">
            <ng-container *ngFor="let cat of [].constructor(6); let i = index">
                <div class="rca-box2 rca-title-text" *ngIf = "(i>=3 && i<=5) && ( i < categoryMapping.size) "  
                    (click) = "mainCategoryClicked(categoryMappingKeys[i])">{{categoryMappingKeys[i]}}</div>
                <div class="empty-box" *ngIf = "(i>=3 && i<=5) && ( i >= categoryMapping.size) "  
                    [innerHTML] = ""></div>
            </ng-container>
        </div>
    </div>
    <div *ngIf = "subcategoriesDisplayed" class="rca-box-row-container rca-samples-container">
        
        <div class="rca-box-row">
            <ng-container *ngFor="let cat of [].constructor(6); let i = index">
              <div class="rca-box2 rca-title-text" *ngIf = "i<=2 && ( i < categoryMapping.get(currentSelectedRCATopic).length )"  
              (click) = "subCategoryClicked(categoryMapping.get(currentSelectedRCATopic)[i])">{{categoryMapping.get(currentSelectedRCATopic)[i]}}</div>
              <div class="empty-box" *ngIf = "i<=2 && ( i >= categoryMapping.get(currentSelectedRCATopic).length )"  
             [innerHTML] = ""></div>
            </ng-container>
        </div>
        <div class="rca-box-row">
            <ng-container *ngFor="let cat of [].constructor(6);let i = index">
              <div class="rca-box2 rca-title-text" *ngIf = "(i>=3 && i<=5) && ( i < categoryMapping.get(currentSelectedRCATopic).length) " 
                (click) = "subCategoryClicked(categoryMapping.get(currentSelectedRCATopic)[i])">{{categoryMapping.get(currentSelectedRCATopic)[i]}}</div>
                <div class="empty-box" *ngIf = "(i>=3 && i<=5) && ( i >= categoryMapping.get(currentSelectedRCATopic).length )" 
                    [innerHTML] = ""></div>
            </ng-container>
        </div>
        <button type="button" class="btn " (click) = "backButtonClicked()"><div class = "btn-text">Back</div></button>
    </div>
</div>


<!-- display loading when RCA is loading -->
<div *ngIf = "rcaLoading" class="rca-bot-container loading-spinner">
    <fab-spinner [size] = "loadingSize" [label] = "'Our premium plan loads faster...'" ></fab-spinner>
</div>

<!-- display the RCA -->
<div *ngIf = "!rcaLoading && rcaDisplayed && !subcategoriesDisplayed && !otherDisplayed" class = "rca-bot-container rca-template-box-header">
    <div class="rca-box-row-container rca-header-container">
        <h1 class="rca-header-text">EasyRCA!</h1>
        <div class = "rca-body-container rca-subtitle-text">The RCA template for <b>{{currentSelectedRCATopic}}</b> is below:
        </div>
        <div class = "rca-body-container rca-body-text rca-result-box" [innerHTML] = "currentSelectedRCA">
        </div>
    </div>
</div>

<!-- displaying "other" mode when clicked  -->
<div *ngIf = "!rcaLoading && !rcaDisplayed && !subcategoriesDisplayed && otherDisplayed" class = "rca-bot-container rca-template-box-header">
    <div class="rca-box-row-container rca-header-container">
        <h1 class="rca-header-text">EasyRCA!</h1>
        <div class = "rca-body-container rca-subtitle-text" >{{otherDisplayText}} 
            <textarea class = "input-box"></textarea>
            <button type="button" class="btn " (click) = "backButtonClicked()"><div class = "btn-text">Back</div></button>
        </div>
       
    </div>
    
   
</div>

<div *ngIf="modifierDisplayed && isEnabledChecked && isEnabled && !rcaLoading && !rcaDisplayed && !subcategoriesDisplayed && !otherDisplayed">
    <openai-chat
      [userId]="userAlias"
      [persistChat]="true"
      [chatAlignment]="'center'"
      [chatIdentifier]="chatComponentIdentifier"
      [chatContextLength]="10"
      [chatQuerySamplesFileUri]="'assets/chatConfigs/easyRCAChatGPT.json'"
      [showFeedbackOptions]="true"
      [showContentDisclaimer]="true"
      [contentDisclaimerMessage]="contentDisclaimerMessage"
      [quotaEnforced]="true"
      [dailyMessageQuota]="20"
      [messageQuotaWarningThreshold]="10"
      [chatHeader]="chatHeader"
      [systemPhotoSource]="'/assets/img/openailogo.svg'"
      [customInitialPrompt]="customInitialPrompt"
    >
    </openai-chat>
  </div>
  
  <div *ngIf="isEnabledChecked && !isEnabled">
    <div class="chatgpt-bot-container">
      ChatGPT is currently disabled in AppLens. Please check back later.
    </div>
  </div>
  
  <div *ngIf="!isEnabledChecked">
    <div class="chatgpt-bot-container">
      Checking ...
    </div>
  </div>